[gd_scene load_steps=5 format=3 uid="uid://i7tc5hlklno8"]

[ext_resource type="Shader" path="res://shaders/transitions.gdshader" id="2_ajtu4"]

[sub_resource type="GDScript" id="GDScript_8fna7"]
script/source = "extends Control

@onready var rect = $TextureRect
@onready var animator = preload(\"res://shaders/AnimatedShader.gd\")
var shader

func _ready():
	shader = animator.new()
	shader.set_material(rect.material, \"time\")
	add_child(shader)
	
func swap_textures():
	var tex = rect.texture
	rect.texture = rect.material.get_shader_parameter(\"secondTexture\")
	rect.material.set_shader_parameter(\"secondTexture\", tex)

func _on_texture_rect_gui_input(event):
	var movable = 40.0
	scale = Vector2(1.0 + 0.1*movable/40, 1.0 + 0.1*movable/40)
	if event is InputEventMouseMotion:
		var x = min(max((event.position.x*1.0 - 1920/2.0)/960.0, -1.0), 1.0)
		var y = min(max((event.position.y*1.0 - 1080/2.0)/540.0, -1.0), 1.0)
		rect.position = Vector2(-movable - x*movable, -movable - y*movable)
"

[sub_resource type="CompressedTexture2D" id="CompressedTexture2D_147d7"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_rnqbo"]
shader = ExtResource("2_ajtu4")
shader_parameter/time = 0.0
shader_parameter/swipe_mode_h = false
shader_parameter/swipe_mode_v = true
shader_parameter/swipe_speed_h = 1.0
shader_parameter/swipe_speed_v = 100.0
shader_parameter/swipe_min_h = -1920.0
shader_parameter/swipe_max_h = 1920.0
shader_parameter/swipe_min_v = -1080.0
shader_parameter/swipe_max_v = 1080.0
shader_parameter/swipe_shift_h = 0.0
shader_parameter/swipe_shift_v = -1080.0
shader_parameter/scale_mode = false
shader_parameter/scale_speed = -20.0
shader_parameter/scale_min = 1.0
shader_parameter/scale_max = 5.0
shader_parameter/scale_shift = 5.0
shader_parameter/shake_mode = false
shader_parameter/shake_v = true
shader_parameter/shake_h = true
shader_parameter/shake_speed = 60.0
shader_parameter/shake_height = 30.0
shader_parameter/shake_time = 4.6
shader_parameter/blend_mode = false
shader_parameter/blend_speed = 3.0
shader_parameter/fade_color = Color(1, 0, 0, 1)
shader_parameter/fade_to = false
shader_parameter/fade_from = false
shader_parameter/fade_speed = 1.0
shader_parameter/slide_h = false
shader_parameter/slide_v = false
shader_parameter/slide_speed = 0.15
shader_parameter/slide_reverse = false
shader_parameter/curtain_speed_h = 0.0
shader_parameter/curtain_speed_v = 0.0
shader_parameter/curtain_h = false
shader_parameter/curtain_v = false
shader_parameter/curtain_reverse_h = false
shader_parameter/curtain_reverse_v = false
shader_parameter/secondTexture = SubResource("CompressedTexture2D_147d7")

[node name="Control" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = SubResource("GDScript_8fna7")

[node name="TextureRect" type="TextureRect" parent="."]
material = SubResource("ShaderMaterial_rnqbo")
clip_contents = true
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
expand_mode = 1
stretch_mode = 2

[connection signal="gui_input" from="TextureRect" to="." method="_on_texture_rect_gui_input"]
